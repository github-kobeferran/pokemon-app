<template>
    <div
        class="container-fluid"
        v-loading.fullscreen.lock="pokemonLoading"
        :element-loading-text="loadingText"
        style="z-index: 99999 !important"
    >
        <div class="row">
            <div class="col text-center">
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    version="1.0"
                    width="200"
                    height="110"
                    viewBox="0 0 2560.000000 942.000000"
                    preserveAspectRatio="xMidYMid meet"
                >
                    <g
                        transform="translate(0.000000,942.000000) scale(0.100000,-0.100000)"
                        fill="#ffaa01"
                        stroke="none"
                    >
                        <path
                            d="M14008 9302 l-207 -107 -557 -640 c-306 -352 -699 -803 -873 -1003 -174 -199 -317 -366 -319 -371 -2 -5 65 -89 148 -186 82 -98 147 -181 144 -184 -3 -3 -78 -45 -167 -93 l-162 -87 -25 23 c-14 13 -326 290 -695 616 -368 326 -682 604 -697 617 l-26 25 -214 -116 -214 -116 -40 -74 -39 -75 -5 168 -5 169 -780 -249 c-429 -137 -951 -304 -1160 -370 l-380 -121 -205 -108 c-113 -60 -213 -115 -222 -122 -16 -12 -16 -48 14 -633 17 -341 32 -621 33 -622 1 -2 89 20 196 47 107 27 197 50 200 50 7 0 33 -269 27 -276 -3 -2 -58 1 -123 8 -393 37 -888 -95 -1254 -336 -47 -31 -86 -54 -89 -51 -2 2 3 44 12 92 113 616 -79 1196 -545 1648 -131 127 -238 207 -432 323 -301 180 -501 252 -859 308 -592 92 -1155 68 -1768 -76 -527 -124 -1101 -344 -1600 -615 -172 -93 -253 -142 -545 -326 l-220 -139 -178 -178 -178 -178 570 -959 c313 -528 576 -961 583 -963 7 -1 102 36 212 83 109 47 202 85 208 83 5 -2 151 -325 324 -718 777 -1764 1518 -3445 1520 -3448 1 -2 395 123 874 278 l873 282 211 140 c116 77 213 142 215 145 5 4 15 -34 -195 773 -89 344 -162 626 -160 627 1 1 22 -32 46 -73 256 -434 661 -721 1136 -805 153 -27 412 -29 559 -5 370 61 711 218 1033 478 l87 69 7 -28 c4 -15 19 -158 33 -317 14 -159 26 -291 28 -292 1 -1 373 53 827 120 l825 123 218 114 219 114 -7 522 -6 523 133 -64 c73 -35 756 -373 1517 -750 761 -377 1385 -686 1388 -686 2 0 98 51 213 113 l210 112 0 712 0 712 38 6 c262 45 549 150 816 298 66 37 120 66 122 64 1 -1 -27 -177 -62 -391 -35 -214 -63 -390 -62 -391 5 -4 1835 -295 1854 -295 10 0 93 40 186 90 92 50 172 90 177 90 5 0 57 -89 116 -197 59 -109 110 -202 115 -206 4 -5 81 32 171 82 90 49 165 88 167 86 2 -2 19 -126 37 -275 18 -149 34 -272 36 -274 2 -1 480 -87 1061 -189 l1057 -187 203 111 c112 61 206 114 210 118 4 3 -11 120 -33 260 -22 139 -38 255 -36 257 2 3 65 13 140 24 151 23 264 53 394 105 48 19 89 33 91 30 3 -3 -13 -168 -35 -367 -23 -200 -40 -364 -39 -365 2 -3 1383 -203 1396 -203 4 0 10 -129 14 -287 4 -159 8 -288 9 -289 1 0 169 -53 372 -118 204 -65 531 -169 727 -231 l358 -114 212 113 c116 61 215 119 220 127 5 7 427 1276 939 2819 896 2702 930 2807 927 2869 l-3 65 -955 233 c-525 128 -964 232 -975 232 -11 1 -87 -35 -169 -79 -82 -44 -152 -78 -154 -75 -3 2 -15 57 -28 121 -13 65 -26 119 -28 121 -4 5 -2256 501 -2306 509 -30 4 -62 -10 -244 -109 l-210 -113 2 -250 c1 -137 5 -402 8 -590 l7 -341 -124 -6 c-357 -20 -688 -125 -992 -317 -54 -34 -100 -60 -102 -58 -1 1 -80 491 -174 1088 -94 597 -173 1095 -176 1108 l-5 22 -772 0 -771 0 -219 -117 c-120 -65 -218 -124 -218 -130 0 -10 -132 -13 -632 -13 l-633 -1 -204 -113 -204 -113 -44 -264 c-24 -144 -45 -265 -47 -267 -3 -2 -40 26 -83 63 -244 209 -577 371 -903 440 -120 25 -269 45 -347 45 -40 0 -73 4 -73 8 0 4 308 174 686 376 447 241 683 373 680 381 -12 32 -948 1420 -959 1422 -7 2 -105 -45 -219 -105z m407 -873 c138 -188 248 -344 245 -347 -7 -9 -1439 -722 -1450 -722 -5 0 -32 33 -60 74 l-50 75 376 453 c530 638 674 808 682 808 4 -1 120 -154 257 -341z m4210 -1191 c3 -13 77 -492 165 -1066 l160 -1044 -62 -76 c-187 -232 -337 -531 -407 -811 -55 -219 -68 -502 -31 -714 33 -198 108 -400 206 -564 150 -249 395 -475 639 -589 44 -21 81 -38 83 -39 3 -3 42 -250 42 -268 0 -6 -18 -7 -47 -3 -64 8 -1118 168 -1119 170 -1 0 -71 459 -155 1018 -84 560 -157 1014 -161 1010 -7 -8 -101 -246 -304 -770 l-129 -334 -45 94 c-25 51 -173 369 -329 706 -156 337 -286 611 -288 609 -2 -3 -12 -56 -23 -118 -18 -105 -240 -1505 -240 -1513 0 -2 -35 3 -77 10 -43 8 -289 50 -548 95 -258 45 -471 82 -472 83 -2 1 31 207 73 457 l76 454 142 145 c77 80 185 190 239 246 l99 101 -171 153 c-94 84 -171 159 -171 166 0 8 81 496 180 1084 99 589 180 1075 180 1080 0 7 189 9 557 8 l557 -3 135 -738 c74 -405 138 -734 141 -730 4 5 73 386 154 848 81 462 149 846 151 853 3 9 92 12 399 12 l396 0 5 -22z m-7367 -512 c487 -464 492 -469 475 -490 -30 -35 -1219 -1292 -1351 -1427 l-64 -67 228 -90 c655 -259 976 -386 1044 -413 74 -29 75 -30 117 -102 102 -176 300 -398 469 -525 284 -213 646 -360 994 -404 l100 -12 0 -483 c0 -266 -3 -483 -6 -483 -3 0 -40 18 -82 39 -43 22 -812 407 -1711 856 l-1633 816 3 -898 4 -897 -130 -19 c-72 -10 -271 -37 -443 -61 -310 -42 -313 -42 -317 -22 -2 12 -17 177 -32 368 l-27 347 72 148 c184 381 255 769 207 1137 -46 347 -183 653 -402 896 l-68 76 -63 749 c-35 412 -65 751 -66 753 -2 1 -90 -20 -196 -48 -106 -27 -195 -49 -197 -47 -4 5 -21 371 -17 378 2 4 16 10 31 13 16 4 271 79 568 168 792 235 815 242 820 237 2 -3 23 -322 45 -709 23 -388 45 -713 48 -722 5 -14 140 169 526 711 514 722 520 730 541 713 11 -9 242 -228 513 -486z m-7078 308 c434 -46 656 -112 922 -271 172 -104 274 -182 386 -294 116 -118 206 -242 277 -384 104 -211 130 -328 129 -580 -1 -209 -17 -306 -88 -520 -184 -553 -628 -1094 -1228 -1496 l-116 -78 20 -78 c11 -43 141 -543 289 -1111 148 -569 269 -1037 269 -1042 0 -8 -226 -84 -730 -244 -112 -36 -208 -62 -212 -58 -6 6 -1905 4238 -1929 4299 -8 21 -15 19 -248 -94 -133 -64 -243 -115 -245 -112 -8 9 -686 1157 -691 1171 -10 25 363 238 656 374 919 427 1769 601 2539 518z m9934 -283 c338 -69 605 -210 845 -447 l123 -123 -198 -212 c-110 -117 -429 -458 -711 -758 -282 -299 -509 -549 -506 -554 9 -14 180 -1 290 23 272 57 454 159 659 367 l100 102 367 -330 c202 -181 367 -334 367 -339 0 -16 -205 -202 -315 -285 -287 -216 -621 -373 -1025 -479 -529 -139 -1027 -103 -1437 105 -398 201 -665 543 -751 964 -60 289 -47 566 39 828 199 610 774 1043 1529 1152 148 22 485 14 624 -14z m8030 -181 c412 -82 750 -151 751 -152 1 -3 458 -2164 493 -2337 12 -55 18 -70 23 -55 5 10 110 440 233 954 313 1297 286 1191 305 1186 14 -5 578 -130 1001 -222 69 -15 128 -30 133 -34 4 -3 -94 -314 -218 -691 -125 -376 -471 -1424 -770 -2329 -299 -905 -562 -1703 -585 -1775 -23 -71 -46 -134 -50 -139 -8 -8 -162 34 -605 167 l-210 63 -35 1479 c-30 1254 -37 1471 -48 1420 -6 -33 -97 -543 -202 -1134 -104 -591 -191 -1075 -192 -1077 -5 -5 -876 131 -883 138 -2 2 11 152 29 333 l32 330 113 110 c192 188 324 369 442 609 261 531 273 1103 33 1581 -65 131 -157 263 -254 364 -60 64 -70 79 -70 110 0 20 16 196 35 391 18 195 33 355 32 356 -1 1 -74 21 -162 44 -88 23 -162 43 -165 45 -3 2 0 88 7 192 6 103 12 196 12 206 1 9 7 17 14 17 7 0 349 -67 761 -150z m-1301 -1148 c451 -117 763 -443 863 -902 26 -116 26 -397 1 -523 -53 -265 -184 -538 -363 -758 -79 -97 -257 -265 -353 -333 -174 -124 -379 -220 -579 -270 -158 -40 -249 -49 -425 -43 -216 7 -359 42 -535 131 -330 167 -567 505 -623 887 -15 104 -6 369 16 469 141 639 661 1176 1290 1335 144 36 226 44 410 41 161 -3 192 -7 298 -34z m-9388 -290 c1 -140 6 -228 19 -305 10 -60 16 -110 14 -112 -2 -1 -110 39 -241 89 l-239 91 222 218 c122 119 223 217 224 217 0 0 1 -89 1 -198z m-3650 -27 c464 -98 805 -396 938 -822 50 -158 61 -237 61 -423 0 -266 -44 -456 -164 -708 -254 -530 -735 -915 -1287 -1032 -145 -31 -377 -37 -518 -15 -526 83 -911 443 -1031 965 -158 685 262 1494 967 1863 177 93 395 163 580 186 108 14 359 6 454 -14z"
                            fill="#ffaa01"
                        />
                        <path
                            d="M4110 5699 c-91 -19 -281 -88 -317 -114 -16 -12 -12 -31 51 -246 60 -206 363 -1189 417 -1356 l20 -63 77 52 c407 273 617 516 688 796 29 115 33 299 8 420 -49 243 -229 426 -496 503 -111 31 -322 36 -448 8z m228 -474 c112 -28 200 -106 229 -205 23 -75 23 -285 0 -353 -16 -49 -16 -49 5 -31 29 27 82 101 112 158 14 27 26 42 26 33 0 -43 -88 -185 -165 -265 l-80 -85 -118 380 c-64 209 -117 383 -117 387 0 7 15 4 108 -19z"
                            fill="#ffaa01"
                        />
                        <path
                            d="M13395 6124 c-337 -55 -612 -311 -680 -635 -22 -103 -19 -268 5 -365 39 -153 127 -304 235 -403 95 -86 70 -98 278 136 609 688 877 995 877 1003 0 4 -30 35 -66 69 -76 69 -206 140 -314 171 -74 21 -267 35 -335 24z m305 -319 c0 -9 -641 -735 -649 -735 -16 0 -52 101 -63 179 -15 99 5 214 53 309 44 86 81 116 168 136 81 18 242 20 316 2 l50 -11 53 62 c46 55 72 75 72 58z"
                            fill="#ffaa01"
                        />
                        <path
                            d="M20220 5149 c-384 -63 -657 -396 -613 -747 37 -290 220 -510 508 -608 67 -23 101 -28 216 -32 166 -5 255 14 398 84 257 126 419 423 381 694 -11 81 -48 194 -77 240 l-19 30 4 -58 c15 -204 -154 -391 -383 -424 -207 -29 -416 75 -501 249 -26 52 -29 68 -29 158 0 88 3 107 27 158 54 114 182 210 318 239 l64 13 -40 7 c-53 9 -187 8 -254 -3z"
                            fill="#ffaa01"
                        />
                        <path
                            d="M7264 4765 c-210 -46 -409 -193 -502 -373 -53 -102 -72 -179 -72 -294 0 -363 267 -655 647 -709 269 -38 560 75 714 280 102 134 144 257 143 426 0 123 -16 191 -67 289 l-32 61 -5 -90 c-7 -106 -34 -173 -98 -246 -90 -101 -209 -151 -357 -151 -194 0 -349 91 -427 250 -30 60 -33 75 -33 157 0 80 3 97 31 155 53 113 149 192 287 236 l72 22 -120 0 c-66 0 -148 -6 -181 -13z"
                            fill="#ffaa01"
                        />
                        <path
                            d="M24040 926 c0 -10 14 -16 43 -18 l42 -3 3 -112 c2 -91 5 -113 17 -113 12 0 15 21 15 115 l0 115 40 0 c29 0 40 4 40 15 0 12 -18 15 -100 15 -80 0 -100 -3 -100 -14z"
                            fill="#ffaa01"
                        />
                        <path
                            d="M24280 810 c0 -109 2 -130 15 -130 12 0 15 19 16 108 l1 107 36 -107 c25 -75 41 -108 52 -108 10 0 26 32 50 103 l35 102 3 -102 c2 -83 6 -103 17 -103 12 0 15 23 15 131 0 129 0 130 -22 127 -18 -2 -29 -21 -59 -107 -20 -57 -38 -100 -41 -95 -3 5 -20 53 -37 107 -29 87 -35 97 -57 97 l-24 0 0 -130z"
                            fill="#ffaa01"
                        />
                    </g>
                </svg>
            </div>
        </div>

        <div class="my-2 w-50 mx-auto">
            <el-input v-model="search" @keyup.enter="fetchWithSearch"  placeholder="Search pokemon..">
                <template #prepend>
                    <el-button @click="fetchWithSearch">
                        <el-icon>
                            <search />
                        </el-icon>
                    </el-button>
                </template>
            </el-input>
        </div>

        <el-pagination
            class="justify-content-center"
            :page-size="20"
            layout="prev, pager, next"
            :page-count="pagination.last_page"
            :current-page="pagination.current_page"
            @current-change="pageChanged"
            background
        />

        <div class="container-fluid d-flex flex-wrap justify-content-center">
            <div class="card m-3" v-for="pokemon in pokemons" :key="pokemon.id">
                <img
                    :src="pokemon.cover_image"
                    :alt="`photo of ${pokemon.name_formatted}`"
                />
                <div class="card-body">
                    <p class="card-text text-center pokemon-font">
                        {{ pokemon.name_formatted }}
                    </p>
                </div>

                <div class="d-flex justify-content-around pb-2">
                    <span v-if="isAuth" class="like-buttons">
                        <svg
                            v-if="hatedPokemons.includes(pokemon.id)"
                            class="active-actions"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            width="15"
                            height="15"
                            @click="unbind(pokemon)"
                        >
                            <path
                                fill="#333"
                                d="M313.4 479.1c26-5.2 42.9-30.5 37.7-56.5l-2.3-11.4c-5.3-26.7-15.1-52.1-28.8-75.2H464c26.5 0 48-21.5 48-48c0-18.5-10.5-34.6-25.9-42.6C497 236.6 504 223.1 504 208c0-23.4-16.8-42.9-38.9-47.1c4.4-7.3 6.9-15.8 6.9-24.9c0-21.3-13.9-39.4-33.1-45.6c.7-3.3 1.1-6.8 1.1-10.4c0-26.5-21.5-48-48-48H294.5c-19 0-37.5 5.6-53.3 16.1L202.7 73.8C176 91.6 160 121.6 160 153.7V192v48 24.9c0 29.2 13.3 56.7 36 75l7.4 5.9c26.5 21.2 44.6 51 51.2 84.2l2.3 11.4c5.2 26 30.5 42.9 56.5 37.7zM32 384H96c17.7 0 32-14.3 32-32V128c0-17.7-14.3-32-32-32H32C14.3 96 0 110.3 0 128V352c0 17.7 14.3 32 32 32z"
                            />
                        </svg>
                        <svg
                            v-else
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            width="15"
                            height="15"
                            class="inactive-actions"
                            :class="{
                                'd-none': hatedPokemons.length > 2,
                            }"
                            @click="bind(pokemon, 'hated')"
                        >
                            <path
                                d="M323.8 477.2c-38.2 10.9-78.1-11.2-89-49.4l-5.7-20c-3.7-13-10.4-25-19.5-35l-51.3-56.4c-8.9-9.8-8.2-25 1.6-33.9s25-8.2 33.9 1.6l51.3 56.4c14.1 15.5 24.4 34 30.1 54.1l5.7 20c3.6 12.7 16.9 20.1 29.7 16.5s20.1-16.9 16.5-29.7l-5.7-20c-5.7-19.9-14.7-38.7-26.6-55.5c-5.2-7.3-5.8-16.9-1.7-24.9s12.3-13 21.3-13L448 288c8.8 0 16-7.2 16-16c0-6.8-4.3-12.7-10.4-15c-7.4-2.8-13-9-14.9-16.7s.1-15.8 5.3-21.7c2.5-2.8 4-6.5 4-10.6c0-7.8-5.6-14.3-13-15.7c-8.2-1.6-15.1-7.3-18-15.2s-1.6-16.7 3.6-23.3c2.1-2.7 3.4-6.1 3.4-9.9c0-6.7-4.2-12.6-10.2-14.9c-11.5-4.5-17.7-16.9-14.4-28.8c.4-1.3 .6-2.8 .6-4.3c0-8.8-7.2-16-16-16H286.5c-12.6 0-25 3.7-35.5 10.7l-61.7 41.1c-11 7.4-25.9 4.4-33.3-6.7s-4.4-25.9 6.7-33.3l61.7-41.1c18.4-12.3 40-18.8 62.1-18.8H384c34.7 0 62.9 27.6 64 62c14.6 11.7 24 29.7 24 50c0 4.5-.5 8.8-1.3 13c15.4 11.7 25.3 30.2 25.3 51c0 6.5-1 12.8-2.8 18.7C504.8 238.3 512 254.3 512 272c0 35.3-28.6 64-64 64l-92.3 0c4.7 10.4 8.7 21.2 11.8 32.2l5.7 20c10.9 38.2-11.2 78.1-49.4 89zM32 384c-17.7 0-32-14.3-32-32V128c0-17.7 14.3-32 32-32H96c17.7 0 32 14.3 32 32V352c0 17.7-14.3 32-32 32H32z"
                            />
                        </svg>
                    </span>
                    <span v-if="isAuth" class="like-buttons">
                        <svg
                            v-if="likedPokemons.includes(pokemon.id)"
                            class="active-actions"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            width="15"
                            height="15"
                            @click="unbind(pokemon)"
                        >
                            <path
                                fill="#3b5998"
                                d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2H464c26.5 0 48 21.5 48 48c0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1c4.4 7.3 6.9 15.8 6.9 24.9c0 21.3-13.9 39.4-33.1 45.6c.7 3.3 1.1 6.8 1.1 10.4c0 26.5-21.5 48-48 48H294.5c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3V320 272 247.1c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192H96c17.7 0 32 14.3 32 32V448c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32V224c0-17.7 14.3-32 32-32z"
                            />
                        </svg>
                        <svg
                            v-else
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            width="15"
                            height="15"
                            class="inactive-actions"
                            :class="{
                                'd-none': likedPokemons.length > 2,
                            }"
                            @click="bind(pokemon, 'liked')"
                        >
                            <path
                                d="M323.8 34.8c-38.2-10.9-78.1 11.2-89 49.4l-5.7 20c-3.7 13-10.4 25-19.5 35l-51.3 56.4c-8.9 9.8-8.2 25 1.6 33.9s25 8.2 33.9-1.6l51.3-56.4c14.1-15.5 24.4-34 30.1-54.1l5.7-20c3.6-12.7 16.9-20.1 29.7-16.5s20.1 16.9 16.5 29.7l-5.7 20c-5.7 19.9-14.7 38.7-26.6 55.5c-5.2 7.3-5.8 16.9-1.7 24.9s12.3 13 21.3 13L448 224c8.8 0 16 7.2 16 16c0 6.8-4.3 12.7-10.4 15c-7.4 2.8-13 9-14.9 16.7s.1 15.8 5.3 21.7c2.5 2.8 4 6.5 4 10.6c0 7.8-5.6 14.3-13 15.7c-8.2 1.6-15.1 7.3-18 15.2s-1.6 16.7 3.6 23.3c2.1 2.7 3.4 6.1 3.4 9.9c0 6.7-4.2 12.6-10.2 14.9c-11.5 4.5-17.7 16.9-14.4 28.8c.4 1.3 .6 2.8 .6 4.3c0 8.8-7.2 16-16 16H286.5c-12.6 0-25-3.7-35.5-10.7l-61.7-41.1c-11-7.4-25.9-4.4-33.3 6.7s-4.4 25.9 6.7 33.3l61.7 41.1c18.4 12.3 40 18.8 62.1 18.8H384c34.7 0 62.9-27.6 64-62c14.6-11.7 24-29.7 24-50c0-4.5-.5-8.8-1.3-13c15.4-11.7 25.3-30.2 25.3-51c0-6.5-1-12.8-2.8-18.7C504.8 273.7 512 257.7 512 240c0-35.3-28.6-64-64-64l-92.3 0c4.7-10.4 8.7-21.2 11.8-32.2l5.7-20c10.9-38.2-11.2-78.1-49.4-89zM32 192c-17.7 0-32 14.3-32 32V448c0 17.7 14.3 32 32 32H96c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32H32z"
                            />
                        </svg>
                    </span>
                    <span v-if="isAuth" class="like-buttons">
                        <svg
                            v-if="pokemon.id == favoritePokemon"
                            class="active-actions"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            width="15"
                            height="15"
                            @click="unbind(pokemon)"
                        >
                            <path
                                fill="red"
                                d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"
                            />
                        </svg>
                        <svg
                            v-else
                            @click="bind(pokemon, 'favorite')"
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            width="15"
                            height="15"
                            class="inactive-actions"
                            :class="{
                                'd-none': favoritePokemon != null,
                            }"
                        >
                            <path
                                d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"
                            />
                        </svg>
                    </span>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
import { mapGetters, mapActions } from "vuex";
import { ElNotification } from "element-plus";

export default {
    data() {
        return {
            loadingText: "Fetching Pokemons",
            search: "",
        };
    },
    created() {
        if (!this.pokemons || this.pokemons.length < 1) {
            this.fetchPokemons();
        }
    },
    mounted() {},
    computed: {
        ...mapGetters("pokemon", {
            pokemons: "getPokemons",
            pagination: "getPagination",
            pokemonLoading: "getLoading",
        }),
        ...mapGetters("auth", {
            isAuth: "getIsAuthenticated",
            user: "getUser",
        }),
        favoritePokemon() {
            const fave = this.user.pokemons.filter((pokemon) => {
                return pokemon.pivot.type == "favorite";
            });

            if (fave && fave.length > 0) {
                return fave[0].id;
            }

            return null;
        },
        favoritePokemon() {
            return this.user.favorite_pokemon_id;
        },
        likedPokemons() {
            return this.user.liked_pokemon_ids;
        },
        hatedPokemons() {
            return this.user.hated_pokemon_ids;
        },
        pageTitle() {
            if (this.isAuth) {
                return `Welcome  ${this.user.first_name}!`;
            } else {
                return `Pokedex`;
            }
        },
    },
    methods: {
        ...mapActions("pokemon", [
            "fetchPokemons",
            "bindPokemon",
            "unbindPokemon",
        ]),
        pageChanged(number) {
            (this.loadingText = "Fetching Pokemons"),
                this.fetchPokemons({
                    page: number,
                });
        },
        bind(pokemon, type, name) {
            this.loadingText = `Looking for ${pokemon.name_formatted}..`;
            this.bindPokemon({
                pokemon_id: pokemon.id,
                type,
            })
                .then((res) => {
                    ElNotification({
                        title: `${pokemon.name_formatted} mark as ${type}`,
                    });
                })
                .catch((error) => {
                    console.log(error);
                    ElNotification({
                        message: error.response.data.message,
                        type: "error",
                    });
                });

            this.loadingText = `Fetching Pokemons`;
        },
        unbind(pokemon) {
            this.loadingText = `Letting go of ${pokemon.name_formatted}..`;
            this.unbindPokemon({ pokemon_id: pokemon.id })
                .then((res) => {})
                .catch((error) => {
                    console.log(error);
                });

            this.loadingText = `Fetching Pokemons`;
        },
        fetchWithSearch() {
            this.fetchPokemons({
                search: this.search,
            });
        },
    },
};
</script>

<style scoped>
body {
    font-family: "Nunito", sans-serif;
    padding: 50px;
}
.card {
    width: 8rem;
    box-shadow: 0 6px 10px rgba(211, 160, 160, 0.08),
        0 0 6px rgba(0, 0, 0, 0.05);
    transition: 0.3s transform cubic-bezier(0.155, 1.105, 0.295, 1.12),
        0.3s box-shadow,
        0.3s -webkit-transform cubic-bezier(0.155, 1.105, 0.295, 1.12);
    cursor: default;
}

.card img {
    padding: 20px;
}

.card:hover {
    transform: scale(1.1);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12), 0 4px 8px rgba(0, 0, 0, 0.06);
    z-index: 9999;
}

.like-buttons {
    cursor: pointer;
}
.like-buttons:hover {
    transform: scale(1.1);
}

.inactive-actions {
    opacity: 0.3;
}
.inactive-actions:hover {
    opacity: 0.6 !important;
}

.active-actions:hover {
}
</style>
